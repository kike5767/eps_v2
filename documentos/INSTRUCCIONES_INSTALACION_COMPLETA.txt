================================================================================
        INSTRUCCIONES COMPLETAS DE INSTALACI√ìN Y CONFIGURACI√ìN
                    EPS V2 FINAL - DESDE ZIP
================================================================================

Fecha: $(Get-Date -Format "dd/MM/yyyy HH:mm:ss")

================================================================================
üìã REQUISITOS PREVIOS - PROGRAMAS A INSTALAR
================================================================================

1. .NET 8.0 SDK (OBLIGATORIO)
   - Descarga: https://dotnet.microsoft.com/download/dotnet/8.0
   - Versi√≥n m√≠nima: .NET SDK 8.0
   - Verificaci√≥n: Abrir PowerShell/CMD y ejecutar: dotnet --version
   - Debe mostrar: 8.0.x o superior
   - Uso: Compila y ejecuta el proyecto

2. SQL Server (OBLIGATORIO)
   - Opci√≥n 1: SQL Server Express (GRATIS)
     * Descarga: https://www.microsoft.com/sql-server/sql-server-downloads
     * Instancia por defecto: localhost\SQLEXPRESS
   - Opci√≥n 2: SQL Server Developer Edition (GRATIS para desarrollo)
     * Descarga: https://www.microsoft.com/sql-server/sql-server-downloads
     * Instancia por defecto: localhost
   - Uso: Almacena la base de datos EPSDB

3. SQL Server Management Studio - SSMS (RECOMENDADO)
   - Descarga: https://aka.ms/ssmsfullsetup
   - Uso: Para ejecutar el script SQL y administrar la base de datos
   - Permite crear la base de datos y ejecutar consultas

4. Visual Studio 2022 o VS Code (OPCIONAL)
   - Visual Studio 2022: https://visualstudio.microsoft.com/
   - VS Code: https://code.visualstudio.com/
   - Uso: Editor de c√≥digo (el proyecto puede compilarse desde terminal)

================================================================================
üîß CONFIGURACI√ìN AUTOM√ÅTICA (RECOMENDADO)
================================================================================

PASO 1: Descomprimir el ZIP
   - Descomprime el archivo EPS_V2_FINAL.zip en cualquier ubicaci√≥n
   - Ejemplo: C:\EPS_V2_FINAL\

PASO 2: Ejecutar Script de Configuraci√≥n
   - Navega a la carpeta del proyecto
   - Ejecuta: CONFIGURAR_PROYECTO_AUTOMATICO.bat (doble clic)
   - El script har√° autom√°ticamente:
     ‚úÖ Verificar .NET SDK 8.0
     ‚úÖ Detectar SQL Server
     ‚úÖ Crear secrets.json con cadena de conexi√≥n
     ‚úÖ Verificar estructura de proyectos
     ‚úÖ Restaurar paquetes NuGet
     ‚úÖ Compilar el proyecto

PASO 3: Ejecutar Script SQL
   - Abre SQL Server Management Studio (SSMS)
   - Con√©ctate a tu servidor SQL (localhost\SQLEXPRESS o localhost)
   - Abre el archivo: lib_repositorios\Script.sql
     O: SCRIPCORREGIDOULTIMO19092025.sql (en la ra√≠z)
   - Ejecuta el script (F5)
   - Verifica que se cre√≥ la base de datos EPSDB

PASO 4: Ejecutar el Proyecto
   - Abre una terminal en la carpeta del proyecto
   - Para ejecutar el API:
     dotnet run --project asp_servicios\asp_servicios.csproj
   - Para ejecutar la UI (en otra terminal):
     dotnet run --project asp_presentacion\asp_presentacion.csproj

================================================================================
üìù CONFIGURACI√ìN MANUAL (SI EL SCRIPT NO FUNCIONA)
================================================================================

1. CREAR ARCHIVO secrets.json
   Ubicaci√≥n: Ra√≠z del proyecto (donde est√° EPS.sln)
   Nombre: secrets.json
   
   Contenido:
   {
     "StringConexion": "Server=localhost\\SQLEXPRESS;Database=EPSDB;Trusted_Connection=True;TrustServerCertificate=True;"
   }
   
   IMPORTANTE: Cambiar seg√∫n tu instalaci√≥n de SQL Server:
   - SQL Server Express: Server=localhost\SQLEXPRESS
   - SQL Server Developer/Standard: Server=localhost
   - Otra instancia: Server=NOMBRE_SERVIDOR\NOMBRE_INSTANCIA
   - Con autenticaci√≥n SQL: Server=...;User Id=usuario;Password=contrase√±a;

2. D√ìNDE SE LEE LA CADENA DE CONEXI√ìN EN EL C√ìDIGO
   Archivo: lib_dominio\Nucleo\DatosGenerales.cs
   L√≠nea: 9
   C√≥digo: public static string ruta_json = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "secrets.json");
   
   Explicaci√≥n: El c√≥digo busca secrets.json subiendo 4 niveles desde donde se ejecuta
   (desde bin/Debug hasta la ra√≠z del proyecto)

3. RESTAURAR PAQUETES NUGET
   Abrir terminal en la carpeta del proyecto y ejecutar:
   dotnet restore EPS.sln

4. COMPILAR EL PROYECTO
   dotnet build EPS.sln --no-incremental

================================================================================
üìÅ ESTRUCTURA DE REFERENCIAS ENTRE PROYECTOS
================================================================================

Orden de compilaci√≥n (las dependencias determinan el orden):

1. lib_dominio (BASE - sin dependencias de otros proyectos)
   - Paquetes NuGet:
     * System.ComponentModel.Annotations (5.0.0)
     * Newtonsoft.Json (13.0.3)
   - Ubicaci√≥n: lib_dominio\lib_dominio.csproj

2. lib_repositorios (depende de lib_dominio)
   - Referencia de proyecto: lib_dominio
   - Paquetes NuGet:
     * Microsoft.EntityFrameworkCore (8.0.8)
     * Microsoft.EntityFrameworkCore.SqlServer (8.0.8)
     * Microsoft.EntityFrameworkCore.Tools (8.0.8)
   - Ubicaci√≥n: lib_repositorios\lib_repositorios.csproj

3. lib_presentaciones (depende de lib_dominio)
   - Referencia de proyecto: lib_dominio
   - Ubicaci√≥n: lib_presentaciones\lib_presentaciones.csproj

4. asp_servicios (depende de lib_dominio y lib_repositorios)
   - Referencias de proyecto: lib_dominio, lib_repositorios
   - Paquetes NuGet:
     * Microsoft.AspNetCore.OpenApi (8.0.15)
     * Swashbuckle.AspNetCore (6.6.2)
     * Microsoft.EntityFrameworkCore (8.0.8) - heredado
     * Microsoft.EntityFrameworkCore.SqlServer (8.0.8) - heredado
   - Ubicaci√≥n: asp_servicios\asp_servicios.csproj

5. asp_presentacion (depende de lib_presentaciones)
   - Referencia de proyecto: lib_presentaciones
   - Paquetes NuGet: ASP.NET Core (incluido en SDK)
   - Ubicaci√≥n: asp_presentacion\asp_presentacion.csproj

6. EPS.Tests (depende de lib_dominio)
   - Referencia de proyecto: lib_dominio
   - Paquetes NuGet:
     * coverlet.collector (6.0.0)
     * Microsoft.NET.Test.Sdk (17.8.0)
     * xunit (2.5.3)
     * xunit.runner.visualstudio (2.5.3)
   - Ubicaci√≥n: Tests\EPS.Tests\EPS.Tests.csproj

================================================================================
üìÇ ARCHIVOS QUE CAMBIAN SUS RUTAS
================================================================================

1. secrets.json
   - Ubicaci√≥n esperada: Ra√≠z del proyecto (donde est√° EPS.sln)
   - Ruta en c√≥digo: lib_dominio\Nucleo\DatosGenerales.cs (l√≠nea 9)
   - Ruta relativa: Path.Combine(..., "..", "..", "..", "..", "secrets.json")
   - Explicaci√≥n: Sube 4 niveles desde bin/Debug hasta la ra√≠z
   - IMPORTANTE: Si mueves el proyecto, aseg√∫rate de que secrets.json est√©
     en la misma carpeta que EPS.sln

2. Script SQL
   - Ubicaciones posibles:
     * lib_repositorios\Script.sql
     * SCRIPCORREGIDOULTIMO19092025.sql (ra√≠z del proyecto)
   - Uso: Debe ejecutarse manualmente en SSMS
   - No cambia autom√°ticamente, se ejecuta una vez para crear la BD

3. Archivos de configuraci√≥n (appsettings.json)
   - Ubicaci√≥n: Cada proyecto tiene su propio appsettings.json
   - asp_servicios\appsettings.json
   - asp_presentacion\appsettings.json
   - Estos archivos NO se usan para la cadena de conexi√≥n principal
   - La cadena de conexi√≥n principal est√° en secrets.json

================================================================================
üîó PAQUETES NUGET - REFERENCIAS EXTERNAS
================================================================================

Los siguientes paquetes se descargan autom√°ticamente al ejecutar:
dotnet restore EPS.sln

NO necesitas instalarlos manualmente, pero aqu√≠ est√° la lista completa:

PROYECTO: lib_dominio
  - System.ComponentModel.Annotations (5.0.0)
  - Newtonsoft.Json (13.0.3)

PROYECTO: lib_repositorios
  - Microsoft.EntityFrameworkCore (8.0.8)
  - Microsoft.EntityFrameworkCore.SqlServer (8.0.8)
  - Microsoft.EntityFrameworkCore.Tools (8.0.8)

PROYECTO: asp_servicios
  - Microsoft.AspNetCore.OpenApi (8.0.15)
  - Swashbuckle.AspNetCore (6.6.2)

PROYECTO: EPS.Tests
  - coverlet.collector (6.0.0)
  - Microsoft.NET.Test.Sdk (17.8.0)
  - xunit (2.5.3)
  - xunit.runner.visualstudio (2.5.3)

================================================================================
‚úÖ VERIFICACI√ìN POST-INSTALACI√ìN
================================================================================

Despu√©s de ejecutar el script de configuraci√≥n, verifica:

1. ‚úÖ .NET SDK instalado:
   dotnet --version
   (Debe mostrar 8.0.x o superior)

2. ‚úÖ SQL Server funcionando:
   sqlcmd -S localhost\SQLEXPRESS -Q "SELECT @@VERSION"
   (O ajusta seg√∫n tu instancia)

3. ‚úÖ secrets.json creado:
   Verificar que existe en la ra√≠z del proyecto
   Contenido correcto con tu servidor SQL

4. ‚úÖ Proyecto compilado:
   dotnet build EPS.sln
   (Debe mostrar "Build succeeded" sin errores)

5. ‚úÖ Base de datos creada:
   En SSMS, verificar que existe la base de datos EPSDB

================================================================================
üöÄ EJECUTAR EL PROYECTO
================================================================================

TERMINAL 1 - API (asp_servicios):
   cd C:\EPS_V2_FINAL
   dotnet run --project asp_servicios\asp_servicios.csproj
   
   El API se ejecutar√° en: http://localhost:5000 o https://localhost:5001
   Swagger UI disponible en: http://localhost:5000/swagger

TERMINAL 2 - UI (asp_presentacion):
   cd C:\EPS_V2_FINAL
   dotnet run --project asp_presentacion\asp_presentacion.csproj
   
   La UI se ejecutar√° en: http://localhost:5002 o https://localhost:5003

IMPORTANTE: El API debe estar ejecut√°ndose antes de abrir la UI.

================================================================================
‚ùì SOLUCI√ìN DE PROBLEMAS COMUNES
================================================================================

PROBLEMA: "dotnet no se reconoce como comando"
SOLUCI√ìN: Instalar .NET 8.0 SDK y reiniciar la terminal

PROBLEMA: "No se puede conectar a SQL Server"
SOLUCI√ìN: 
  - Verificar que SQL Server est√© ejecut√°ndose
  - Verificar el nombre de la instancia en secrets.json
  - Probar: sqlcmd -S localhost\SQLEXPRESS -Q "SELECT 1"

PROBLEMA: "No se encuentra secrets.json"
SOLUCI√ìN:
  - Crear el archivo manualmente en la ra√≠z del proyecto
  - Verificar que est√© en la misma carpeta que EPS.sln

PROBLEMA: "Error al restaurar paquetes NuGet"
SOLUCI√ìN:
  - Verificar conexi√≥n a internet
  - Ejecutar: dotnet nuget locals all --clear
  - Ejecutar: dotnet restore EPS.sln

PROBLEMA: "Error de compilaci√≥n"
SOLUCI√ìN:
  - Verificar que todos los proyectos est√©n en la soluci√≥n
  - Verificar que las referencias entre proyectos sean correctas
  - Ejecutar: dotnet clean EPS.sln
  - Ejecutar: dotnet build EPS.sln --no-incremental

PROBLEMA: "Base de datos no existe"
SOLUCI√ìN:
  - Ejecutar el script SQL en SSMS
  - Verificar que el nombre de la base de datos en secrets.json sea EPSDB

================================================================================
üìû INFORMACI√ìN ADICIONAL
================================================================================

- Repositorio GitHub: https://github.com/kike5767/eps_v2.git
- Video YouTube: https://youtu.be/GVyz4-I0t_0
- Documentaci√≥n completa: documentos\GUIA_COMPLETA_ESTUDIO.html

================================================================================
üéâ ¬°PROYECTO LISTO PARA USAR!
================================================================================

Si seguiste todos los pasos, el proyecto deber√≠a estar:
‚úÖ Compilado sin errores
‚úÖ Base de datos creada
‚úÖ API ejecut√°ndose
‚úÖ UI ejecut√°ndose

¬°√âxito con tu proyecto! üöÄ

================================================================================

