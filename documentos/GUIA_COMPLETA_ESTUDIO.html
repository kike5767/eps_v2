<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Gu√≠a Completa de Estudio - EPS V2 Final</title>
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; margin: 40px; line-height: 1.8; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 40px; box-shadow: 0 0 20px rgba(0,0,0,0.1); }
        h1 { color: #7B2CBF; border-bottom: 4px solid #7B2CBF; padding-bottom: 15px; }
        h2 { color: #5A189A; margin-top: 40px; border-left: 5px solid #7B2CBF; padding-left: 15px; }
        h3 { color: #9D4EDD; margin-top: 30px; }
        .step { background: #f8f9fa; border-left: 4px solid #7B2CBF; padding: 20px; margin: 20px 0; }
        .code { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 5px; font-family: 'Consolas', monospace; overflow-x: auto; }
        .important { background: #fff3cd; border-left: 4px solid #ffc107; padding: 15px; margin: 20px 0; }
        .success { background: #d4edda; border-left: 4px solid #28a745; padding: 15px; margin: 20px 0; }
        .warning { background: #f8d7da; border-left: 4px solid #dc3545; padding: 15px; margin: 20px 0; }
        ul { margin: 15px 0; }
        li { margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
        th { background-color: #7B2CBF; color: white; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        .highlight { background: yellow; padding: 2px 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìö GU√çA COMPLETA DE ESTUDIO - EPS V2 FINAL</h1>
        <p><strong>Para Sustentaci√≥n con el Profesor</strong></p>
        <p><strong>Fecha:</strong> <span id="fecha"></span></p>

        <div class="important">
            <h3>üéØ Objetivo de esta Gu√≠a</h3>
            <p>Esta gu√≠a te ayudar√° a entender completamente el proyecto EPS V2 Final para poder sustentarlo exitosamente con tu profesor. Cada paso est√° explicado en detalle con comentarios y explicaciones t√©cnicas.</p>
        </div>

        <h2>üìã √çNDICE</h2>
        <ol>
            <li><a href="#estructura">Estructura del Proyecto</a></li>
            <li><a href="#arquitectura">Arquitectura en Capas</a></li>
            <li><a href="#compilacion">Proceso de Compilaci√≥n</a></li>
            <li><a href="#pruebas">Pruebas Unitarias</a></li>
            <li><a href="#api">API REST (asp_servicios)</a></li>
            <li><a href="#ui">Interfaz de Usuario (asp_presentacion)</a></li>
            <li><a href="#crud">Operaciones CRUD</a></li>
            <li><a href="#sql">Base de Datos SQL Server</a></li>
            <li><a href="#comentarios">Comentarios L√≠nea por L√≠nea</a></li>
            <li><a href="#sustentacion">Preguntas para Sustentaci√≥n</a></li>
            <li><a href="#instalacion">Instalaci√≥n y Configuraci√≥n Inicial</a></li>
        </ol>

        <h2 id="estructura">1. ESTRUCTURA DEL PROYECTO</h2>
        
        <div class="step">
            <h3>1.1 ¬øPor qu√© esta estructura?</h3>
            <p>El proyecto sigue la <strong>arquitectura en capas</strong> que el profesor requiere, igual a la referencia <code>panaderia_ref</code>. Esta estructura separa las responsabilidades y facilita el mantenimiento.</p>
            
            <h4>Explicaci√≥n de cada carpeta:</h4>
            <ul>
                <li><strong>1. presentaciones:</strong> Contiene la interfaz de usuario (UI) y las comunicaciones con el API</li>
                <li><strong>2. servicios:</strong> Contiene el API REST y los repositorios que acceden a la base de datos</li>
                <li><strong>3. nucleo:</strong> Contiene las entidades y clases base que se usan en todo el proyecto</li>
                <li><strong>4. pruebas unitarias:</strong> Contiene las pruebas automatizadas del proyecto</li>
            </ul>
        </div>

        <div class="step">
            <h3>1.2 Proyectos en la Soluci√≥n</h3>
            <table>
                <tr>
                    <th>Proyecto</th>
                    <th>Prop√≥sito</th>
                    <th>Dependencias</th>
                </tr>
                <tr>
                    <td><strong>lib_dominio</strong></td>
                    <td>Entidades y clases base (JsonConversor, EncodingHelper, etc.)</td>
                    <td>Ninguna (proyecto base)</td>
                </tr>
                <tr>
                    <td><strong>lib_repositorios</strong></td>
                    <td>Acceso a datos (Conexion, Aplicaciones, TokenAplicacion)</td>
                    <td>lib_dominio</td>
                </tr>
                <tr>
                    <td><strong>lib_presentaciones</strong></td>
                    <td>Comunicaciones HTTP con el API (Comunicaciones, Interfaces)</td>
                    <td>lib_dominio</td>
                </tr>
                <tr>
                    <td><strong>asp_servicios</strong></td>
                    <td>API REST (Controllers, Configuracion, Startup)</td>
                    <td>lib_dominio, lib_repositorios</td>
                </tr>
                <tr>
                    <td><strong>asp_presentacion</strong></td>
                    <td>Interfaz Razor Pages (UI con tema morado)</td>
                    <td>lib_presentaciones</td>
                </tr>
                <tr>
                    <td><strong>EPS.Tests</strong></td>
                    <td>Pruebas unitarias del proyecto</td>
                    <td>lib_dominio</td>
                </tr>
            </table>
        </div>

        <h2 id="arquitectura">2. ARQUITECTURA EN CAPAS</h2>

        <div class="step">
            <h3>2.1 Flujo de Datos</h3>
            <p>El flujo de datos sigue este orden:</p>
            <ol>
                <li><strong>UI (asp_presentacion):</strong> El usuario interact√∫a con la interfaz</li>
                <li><strong>lib_presentaciones:</strong> Env√≠a peticiones HTTP al API</li>
                <li><strong>API (asp_servicios):</strong> Recibe las peticiones y valida tokens</li>
                <li><strong>lib_repositorios:</strong> Ejecuta operaciones en la base de datos</li>
                <li><strong>lib_dominio:</strong> Define las entidades y reglas de negocio</li>
                <li><strong>SQL Server:</strong> Almacena los datos</li>
            </ol>
        </div>

        <div class="step">
            <h3>2.2 ¬øPor qu√© esta separaci√≥n?</h3>
            <ul>
                <li><strong>Separaci√≥n de responsabilidades:</strong> Cada capa tiene una funci√≥n espec√≠fica</li>
                <li><strong>Mantenibilidad:</strong> Es m√°s f√°cil modificar una capa sin afectar las otras</li>
                <li><strong>Reutilizaci√≥n:</strong> Las clases base se pueden usar en m√∫ltiples proyectos</li>
                <li><strong>Pruebas:</strong> Cada capa se puede probar independientemente</li>
            </ul>
        </div>

        <h2 id="compilacion">3. PROCESO DE COMPILACI√ìN</h2>

        <div class="step">
            <h3>3.1 ¬øQu√© es la compilaci√≥n?</h3>
            <p>La compilaci√≥n es el proceso de convertir el c√≥digo fuente (archivos .cs) en archivos ejecutables (.dll).</p>
            
            <h4>Orden de compilaci√≥n:</h4>
            <ol>
                <li><strong>lib_dominio:</strong> Se compila primero porque otros proyectos lo necesitan</li>
                <li><strong>lib_repositorios:</strong> Depende de lib_dominio</li>
                <li><strong>lib_presentaciones:</strong> Depende de lib_dominio</li>
                <li><strong>asp_servicios:</strong> Depende de lib_dominio y lib_repositorios</li>
                <li><strong>asp_presentacion:</strong> Depende de lib_presentaciones</li>
                <li><strong>EPS.Tests:</strong> Depende de lib_dominio</li>
            </ol>
        </div>

        <div class="step">
            <h3>3.2 Comando de Compilaci√≥n</h3>
            <div class="code">
dotnet build EPS.sln --no-incremental
            </div>
            <p><strong>Explicaci√≥n:</strong></p>
            <ul>
                <li><code>dotnet build</code>: Compila el proyecto</li>
                <li><code>EPS.sln</code>: Archivo de soluci√≥n que contiene todos los proyectos</li>
                <li><code>--no-incremental</code>: Fuerza una compilaci√≥n completa (no usa cach√©)</li>
            </ul>
        </div>

        <h2 id="pruebas">4. PRUEBAS UNITARIAS</h2>

        <div class="step">
            <h3>4.1 ¬øQu√© son las pruebas unitarias?</h3>
            <p>Las pruebas unitarias verifican que cada parte del c√≥digo funciona correctamente de forma independiente.</p>
            
            <h4>Tipos de pruebas en el proyecto:</h4>
            <ul>
                <li><strong>Validaci√≥n de entidades:</strong> Verifica que las entidades tengan los datos correctos</li>
                <li><strong>Pruebas de servicios:</strong> Verifica la l√≥gica de negocio</li>
            </ul>
        </div>

        <div class="step">
            <h3>4.2 Ejecutar Pruebas</h3>
            <div class="code">
dotnet test Tests/EPS.Tests/EPS.Tests.csproj --verbosity normal
            </div>
            <p><strong>Resultado esperado:</strong></p>
            <div class="success">
                ‚úÖ Passed: X<br>
                ‚ùå Failed: 0<br>
                ‚è≠Ô∏è Skipped: 0
            </div>
        </div>

        <h2 id="api">5. API REST (asp_servicios)</h2>

        <div class="step">
            <h3>5.1 ¬øQu√© es el API?</h3>
            <p>El API (Application Programming Interface) es el servicio que recibe peticiones HTTP y devuelve respuestas en formato JSON.</p>
            
            <h4>Componentes principales:</h4>
            <ul>
                <li><strong>Controllers:</strong> Reciben las peticiones HTTP (TokenController, AfiliadosController)</li>
                <li><strong>Startup.cs:</strong> Configura los servicios y el pipeline HTTP</li>
                <li><strong>Configuracion.cs:</strong> Lee la cadena de conexi√≥n desde secrets.json</li>
            </ul>
        </div>

        <div class="step">
            <h3>5.2 Flujo de una Petici√≥n al API</h3>
            <ol>
                <li><strong>Cliente env√≠a petici√≥n:</strong> POST /Afiliados/Listar</li>
                <li><strong>TokenController valida:</strong> Verifica que la llave sea correcta</li>
                <li><strong>AfiliadosController procesa:</strong> Obtiene los datos del repositorio</li>
                <li><strong>AfiliadosAplicacion ejecuta:</strong> Consulta la base de datos</li>
                <li><strong>Respuesta JSON:</strong> Devuelve los datos al cliente</li>
            </ol>
        </div>

        <div class="step">
            <h3>5.3 Rutas del API</h3>
            <p>Todas las rutas siguen el patr√≥n: <code>[controller]/[action]</code></p>
            <ul>
                <li><code>Token/Llave</code>: Obtiene la llave de autenticaci√≥n</li>
                <li><code>Afiliados/Listar</code>: Lista todos los afiliados</li>
                <li><code>Afiliados/Guardar</code>: Guarda un nuevo afiliado</li>
                <li><code>Afiliados/Modificar</code>: Modifica un afiliado existente</li>
                <li><code>Afiliados/Borrar</code>: Borra un afiliado</li>
            </ul>
        </div>

        <h2 id="ui">6. INTERFAZ DE USUARIO (asp_presentacion)</h2>

        <div class="step">
            <h3>6.1 ¬øQu√© es Razor Pages?</h3>
            <p>Razor Pages es una tecnolog√≠a de Microsoft que permite crear p√°ginas web din√°micas usando C# y HTML.</p>
            
            <h4>Archivos principales:</h4>
            <ul>
                <li><strong>Afiliados.cshtml:</strong> Vista HTML con el formulario y tabla</li>
                <li><strong>Afiliados.cshtml.cs:</strong> C√≥digo C# que maneja la l√≥gica de la p√°gina</li>
                <li><strong>site.css:</strong> Estilos CSS con el tema morado</li>
            </ul>
        </div>

        <div class="step">
            <h3>6.2 Tema Morado</h3>
            <p>El tema morado usa estos colores:</p>
            <ul>
                <li><strong>Color principal:</strong> #7B2CBF (morado oscuro)</li>
                <li><strong>Color secundario:</strong> #C77DFF (morado claro)</li>
                <li><strong>Color de acento:</strong> #E0AAFF (morado muy claro)</li>
            </ul>
            <p>Estos colores se aplican a: navbar, botones, cards, tablas y footer.</p>
        </div>

        <h2 id="crud">7. OPERACIONES CRUD</h2>

        <div class="step">
            <h3>7.1 ¬øQu√© es CRUD?</h3>
            <p>CRUD significa: <strong>C</strong>reate (Crear), <strong>R</strong>ead (Leer), <strong>U</strong>pdate (Actualizar), <strong>D</strong>elete (Borrar).</p>
        </div>

        <div class="step">
            <h3>7.2 CREATE (Crear)</h3>
            <ol>
                <li>Usuario llena el formulario en la UI</li>
                <li>UI env√≠a petici√≥n POST a /Afiliados/Guardar</li>
                <li>API valida el token</li>
                <li>API valida que el Id sea 0 (nuevo registro)</li>
                <li>Repositorio inserta en la base de datos</li>
                <li>Se devuelve el afiliado con su nuevo ID</li>
            </ol>
        </div>

        <div class="step">
            <h3>7.3 READ (Leer/Listar)</h3>
            <ol>
                <li>Usuario carga la p√°gina de Afiliados</li>
                <li>UI env√≠a petici√≥n POST a /Afiliados/Listar</li>
                <li>API valida el token</li>
                <li>Repositorio consulta la base de datos (m√°ximo 50 registros)</li>
                <li>Se devuelve la lista de afiliados</li>
                <li>UI muestra los datos en una tabla</li>
            </ol>
        </div>

        <div class="step">
            <h3>7.4 UPDATE (Actualizar)</h3>
            <ol>
                <li>Usuario hace clic en "Editar"</li>
                <li>UI carga los datos del afiliado</li>
                <li>Usuario modifica los datos</li>
                <li>UI env√≠a petici√≥n POST a /Afiliados/Modificar</li>
                <li>API valida que el Id sea mayor a 0 (registro existente)</li>
                <li>Repositorio actualiza en la base de datos</li>
            </ol>
        </div>

        <div class="step">
            <h3>7.5 DELETE (Borrar)</h3>
            <ol>
                <li>Usuario hace clic en "Borrar"</li>
                <li>UI muestra confirmaci√≥n</li>
                <li>UI env√≠a petici√≥n POST a /Afiliados/Borrar</li>
                <li>API valida que el Id sea mayor a 0</li>
                <li>Repositorio elimina de la base de datos</li>
            </ol>
        </div>

        <h2 id="sql">8. BASE DE DATOS SQL SERVER</h2>

        <div class="step">
            <h3>8.1 Estructura de la Base de Datos</h3>
            <p>La base de datos <strong>EPSDB</strong> contiene las siguientes tablas principales:</p>
            <ul>
                <li><strong>Afiliado:</strong> Informaci√≥n de los afiliados</li>
                <li><strong>Usuario:</strong> Usuarios del sistema</li>
                <li><strong>Contrato:</strong> Contratos de los afiliados</li>
                <li><strong>Cita:</strong> Citas m√©dicas</li>
                <li><strong>Factura:</strong> Facturas de pagos</li>
                <li>Y m√°s tablas relacionadas...</li>
            </ul>
        </div>

        <div class="step">
            <h3>8.2 Entity Framework Core</h3>
            <p>El proyecto usa <strong>Entity Framework Core</strong> para acceder a la base de datos.</p>
            
            <h4>Ventajas:</h4>
            <ul>
                <li>No necesitas escribir SQL manualmente</li>
                <li>Las entidades C# se mapean autom√°ticamente a tablas</li>
                <li>Cambios en el c√≥digo se reflejan en la base de datos</li>
            </ul>
        </div>

        <div class="step">
            <h3>8.3 Conexi√≥n a la Base de Datos</h3>
            <p>La cadena de conexi√≥n se lee desde <code>secrets.json</code>:</p>
            <div class="code">
{
  "StringConexion": "Server=localhost\\SQLEXPRESS;Database=EPSDB;Trusted_Connection=True;TrustServerCertificate=True;"
}
            </div>
            <p><strong>Explicaci√≥n:</strong></p>
            <ul>
                <li><code>Server=localhost\SQLEXPRESS</code>: Servidor de SQL Server</li>
                <li><code>Database=EPSDB</code>: Nombre de la base de datos</li>
                <li><code>Trusted_Connection=True</code>: Usa autenticaci√≥n de Windows</li>
            </ul>
        </div>

        <h2 id="comentarios">9. COMENTARIOS L√çNEA POR L√çNEA</h2>

        <div class="step">
            <h3>9.1 ¬øPor qu√© comentarios l√≠nea por l√≠nea?</h3>
            <p>El profesor requiere comentarios en cada l√≠nea para:</p>
            <ul>
                <li><strong>Documentaci√≥n:</strong> Explicar qu√© hace cada parte del c√≥digo</li>
                <li><strong>Mantenimiento:</strong> Facilitar futuras modificaciones</li>
                <li><strong>Ense√±anza:</strong> Ayudar a entender el c√≥digo</li>
            </ul>
        </div>

        <div class="step">
            <h3>9.2 Ejemplo de Comentarios</h3>
            <div class="code">
// Controlador para operaciones CRUD de Afiliados
// Proporciona endpoints para listar, guardar, modificar y borrar afiliados
using asp_servicios.Nucleo;
using lib_dominio.Entidades;

namespace asp_servicios.Controllers
{
    // Marca esta clase como un controlador de API
    [ApiController]
    // Define la ruta base: /Afiliados/[action]
    [Route("[controller]/[action]")]
    public class AfiliadosController : ControllerBase
    {
        // Instancia de la aplicaci√≥n de afiliados
        private IAfiliadosAplicacion? iAplicacion = null;
        
        // Constructor que recibe las aplicaciones por inyecci√≥n de dependencias
        public AfiliadosController(IAfiliadosAplicacion? iAplicacion, TokenAplicacion iAplicacionToken)
        {
            this.iAplicacion = iAplicacion;
        }
    }
}
            </div>
        </div>

        <h2 id="sustentacion">10. PREGUNTAS PARA SUSTENTACI√ìN</h2>

        <div class="step">
            <h3>10.1 Preguntas sobre Arquitectura</h3>
            <p><strong>P: ¬øPor qu√© separaste el proyecto en capas?</strong></p>
            <p><strong>R:</strong> Para seguir la arquitectura en capas que el profesor requiere, igual a la referencia panaderia_ref. Esto permite separar responsabilidades, facilitar el mantenimiento y hacer el c√≥digo m√°s reutilizable.</p>
            
            <p><strong>P: ¬øQu√© hace cada capa?</strong></p>
            <p><strong>R:</strong></p>
            <ul>
                <li><strong>Presentaci√≥n:</strong> Interfaz de usuario y comunicaciones</li>
                <li><strong>Servicios:</strong> API REST y l√≥gica de negocio</li>
                <li><strong>Repositorios:</strong> Acceso a datos</li>
                <li><strong>Dominio:</strong> Entidades y clases base</li>
            </ul>
        </div>

        <div class="step">
            <h3>10.2 Preguntas sobre el API</h3>
            <p><strong>P: ¬øC√≥mo funciona la autenticaci√≥n?</strong></p>
            <p><strong>R:</strong> El API usa tokens. Primero se obtiene una llave desde Token/Llave, luego cada petici√≥n debe incluir esa llave en el cuerpo. El TokenAplicacion valida que la llave sea correcta.</p>
            
            <p><strong>P: ¬øPor qu√© usas rutas [controller]/[action]?</strong></p>
            <p><strong>R:</strong> Es el patr√≥n que el profesor requiere, igual a la referencia. Permite que las rutas sean autom√°ticas basadas en el nombre del controlador y el m√©todo.</p>
        </div>

        <div class="step">
            <h3>10.3 Preguntas sobre la UI</h3>
            <p><strong>P: ¬øPor qu√© tema morado?</strong></p>
            <p><strong>R:</strong> El profesor solicit√≥ un tema morado mejorado. Usa el color #7B2CBF como principal, aplicado a navbar, botones, cards y tablas.</p>
            
            <p><strong>P: ¬øC√≥mo se comunica la UI con el API?</strong></p>
            <p><strong>R:</strong> A trav√©s de la clase Comunicaciones en lib_presentaciones, que usa HttpClient para enviar peticiones HTTP POST al API.</p>
        </div>

        <div class="step">
            <h3>10.4 Preguntas sobre CRUD</h3>
            <p><strong>P: ¬øC√≥mo validas que un registro sea nuevo o existente?</strong></p>
            <p><strong>R:</strong> Si el Id es 0, es nuevo (Guardar). Si el Id es mayor a 0, es existente (Modificar o Borrar).</p>
            
            <p><strong>P: ¬øQu√© validaciones haces antes de guardar?</strong></p>
            <p><strong>R:</strong> Valido que la entidad no sea nula, que el Id sea correcto (0 para nuevo, >0 para existente), y luego ejecuto la operaci√≥n en la base de datos.</p>
        </div>

        <div class="step">
            <h3>10.5 Preguntas sobre Base de Datos</h3>
            <p><strong>P: ¬øPor qu√© usas Entity Framework Core?</strong></p>
            <p><strong>R:</strong> Es el ORM (Object-Relational Mapping) est√°ndar de .NET. Permite trabajar con objetos C# en lugar de SQL directo, facilitando el desarrollo y mantenimiento.</p>
            
            <p><strong>P: ¬øD√≥nde est√° la cadena de conexi√≥n?</strong></p>
            <p><strong>R:</strong> En secrets.json en la ra√≠z del proyecto. Se lee mediante Configuracion.cs que usa DatosGenerales.ruta_json para encontrar el archivo.</p>
        </div>

        <div class="step">
            <h3>10.6 Preguntas sobre Comentarios</h3>
            <p><strong>P: ¬øPor qu√© comentarios l√≠nea por l√≠nea?</strong></p>
            <p><strong>R:</strong> Es un requisito expl√≠cito del profesor. Cada archivo .cs tiene comentarios que explican qu√© hace cada l√≠nea, facilitando la comprensi√≥n y mantenimiento del c√≥digo.</p>
        </div>

        <div class="success">
            <h3>‚úÖ RESUMEN PARA SUSTENTACI√ìN</h3>
            <p>Recuerda mencionar:</p>
            <ul>
                <li>‚úÖ Estructura igual a panaderia_ref (requisito del profesor)</li>
                <li>‚úÖ Comentarios l√≠nea por l√≠nea en todos los archivos .cs</li>
                <li>‚úÖ Tema morado mejorado en la UI</li>
                <li>‚úÖ Arquitectura en capas bien definida</li>
                <li>‚úÖ CRUD completo funcionando</li>
                <li>‚úÖ Pruebas unitarias implementadas</li>
                <li>‚úÖ Compilaci√≥n exitosa sin errores</li>
            </ul>
        </div>

        <h2 id="instalacion">11. INSTALACI√ìN Y CONFIGURACI√ìN INICIAL</h2>

        <div class="step">
            <h3>11.1 Programas Requeridos</h3>
            <p>Para que el proyecto compile y ejecute correctamente despu√©s de descomprimir el ZIP, se necesitan los siguientes programas:</p>
            
            <h4>1. .NET 8.0 SDK (OBLIGATORIO)</h4>
            <ul>
                <li><strong>Descarga:</strong> https://dotnet.microsoft.com/download/dotnet/8.0</li>
                <li><strong>Versi√≥n m√≠nima:</strong> .NET SDK 8.0</li>
                <li><strong>Verificaci√≥n:</strong> Ejecutar <code>dotnet --version</code> en la terminal</li>
                <li><strong>Uso:</strong> Compila y ejecuta el proyecto</li>
            </ul>

            <h4>2. SQL Server (OBLIGATORIO)</h4>
            <ul>
                <li><strong>Opciones:</strong>
                    <ul>
                        <li>SQL Server Express (gratis): https://www.microsoft.com/sql-server/sql-server-downloads</li>
                        <li>SQL Server Developer Edition (gratis para desarrollo)</li>
                    </ul>
                </li>
                <li><strong>Instancia por defecto:</strong> localhost\SQLEXPRESS o localhost</li>
                <li><strong>Uso:</strong> Almacena la base de datos EPSDB</li>
            </ul>

            <h4>3. SQL Server Management Studio - SSMS (RECOMENDADO)</h4>
            <ul>
                <li><strong>Descarga:</strong> https://aka.ms/ssmsfullsetup</li>
                <li><strong>Uso:</strong> Para ejecutar el script SQL y administrar la base de datos</li>
            </ul>

            <h4>4. Visual Studio 2022 o VS Code (OPCIONAL)</h4>
            <ul>
                <li><strong>Visual Studio 2022:</strong> https://visualstudio.microsoft.com/</li>
                <li><strong>VS Code:</strong> https://code.visualstudio.com/</li>
                <li><strong>Uso:</strong> Editor de c√≥digo (el proyecto puede compilarse desde la terminal)</li>
            </ul>
        </div>

        <div class="step">
            <h3>11.2 Configuraci√≥n de la Cadena de Conexi√≥n</h3>
            <p>La cadena de conexi√≥n se configura en el archivo <strong>secrets.json</strong> en la ra√≠z del proyecto.</p>
            
            <h4>Ubicaci√≥n del archivo:</h4>
            <div class="code">
C:\EPS_V2_FINAL\secrets.json
            </div>

            <h4>Contenido del archivo:</h4>
            <div class="code">
{
  "StringConexion": "Server=localhost\\SQLEXPRESS;Database=EPSDB;Trusted_Connection=True;TrustServerCertificate=True;"
}
            </div>

            <h4>D√≥nde se lee en el c√≥digo:</h4>
            <ul>
                <li><strong>Archivo:</strong> <code>lib_dominio\Nucleo\DatosGenerales.cs</code></li>
                <li><strong>L√≠nea:</strong> 9</li>
                <li><strong>C√≥digo:</strong> <code>public static string ruta_json = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, "..", "..", "..", "..", "secrets.json");</code></li>
            </ul>

            <h4>Qu√© cambiar seg√∫n tu instalaci√≥n:</h4>
            <ul>
                <li><strong>Si usas SQL Server Express:</strong> <code>Server=localhost\SQLEXPRESS</code></li>
                <li><strong>Si usas SQL Server Developer/Standard:</strong> <code>Server=localhost</code></li>
                <li><strong>Si usas otra instancia:</strong> <code>Server=NOMBRE_SERVIDOR\NOMBRE_INSTANCIA</code></li>
                <li><strong>Si usas autenticaci√≥n SQL:</strong> <code>Server=...;User Id=usuario;Password=contrase√±a;</code></li>
            </ul>
        </div>

        <div class="step">
            <h3>11.3 Referencias entre Proyectos</h3>
            <p>El proyecto tiene dependencias entre capas que deben compilarse en orden:</p>
            
            <h4>Orden de dependencias:</h4>
            <ol>
                <li><strong>lib_dominio</strong> (base, sin dependencias de otros proyectos)
                    <ul>
                        <li>Paquetes NuGet: System.ComponentModel.Annotations, Newtonsoft.Json</li>
                    </ul>
                </li>
                <li><strong>lib_repositorios</strong> (depende de lib_dominio)
                    <ul>
                        <li>Referencia: lib_dominio</li>
                        <li>Paquetes NuGet: Entity Framework Core, Entity Framework Core SQL Server</li>
                    </ul>
                </li>
                <li><strong>lib_presentaciones</strong> (depende de lib_dominio)
                    <ul>
                        <li>Referencia: lib_dominio</li>
                    </ul>
                </li>
                <li><strong>asp_servicios</strong> (depende de lib_dominio y lib_repositorios)
                    <ul>
                        <li>Referencias: lib_dominio, lib_repositorios</li>
                        <li>Paquetes NuGet: ASP.NET Core, Swagger, Entity Framework Core</li>
                    </ul>
                </li>
                <li><strong>asp_presentacion</strong> (depende de lib_presentaciones)
                    <ul>
                        <li>Referencia: lib_presentaciones</li>
                        <li>Paquetes NuGet: ASP.NET Core Razor Pages</li>
                    </ul>
                </li>
                <li><strong>EPS.Tests</strong> (depende de lib_dominio)
                    <ul>
                        <li>Referencia: lib_dominio</li>
                        <li>Paquetes NuGet: xUnit, Microsoft.NET.Test.Sdk</li>
                    </ul>
                </li>
            </ol>
        </div>

        <div class="step">
            <h3>11.4 Archivos que Cambian sus Rutas</h3>
            <p>Algunos archivos tienen rutas relativas que pueden necesitar ajuste seg√∫n d√≥nde se descomprima el proyecto:</p>
            
            <h4>1. secrets.json</h4>
            <ul>
                <li><strong>Ubicaci√≥n esperada:</strong> Ra√≠z del proyecto (donde est√° EPS.sln)</li>
                <li><strong>Ruta en c√≥digo:</strong> <code>lib_dominio\Nucleo\DatosGenerales.cs</code> l√≠nea 9</li>
                <li><strong>Ruta relativa:</strong> <code>Path.Combine(..., "..", "..", "..", "..", "secrets.json")</code></li>
                <li><strong>Nota:</strong> Esta ruta asume que el proyecto se ejecuta desde bin/Debug, por lo que sube 4 niveles</li>
            </ul>

            <h4>2. Script SQL</h4>
            <ul>
                <li><strong>Ubicaciones posibles:</strong>
                    <ul>
                        <li><code>lib_repositorios\Script.sql</code></li>
                        <li><code>SCRIPCORREGIDOULTIMO19092025.sql</code> (ra√≠z)</li>
                    </ul>
                </li>
                <li><strong>Uso:</strong> Debe ejecutarse manualmente en SSMS</li>
            </ul>
        </div>

        <div class="step">
            <h3>11.5 Configuraci√≥n Autom√°tica con Script .bat</h3>
            <p>El proyecto incluye un script <strong>CONFIGURAR_PROYECTO_AUTOMATICO.bat</strong> que hace todo autom√°ticamente:</p>
            
            <h4>¬øQu√© hace el script?</h4>
            <ol>
                <li>Verifica que .NET 8.0 SDK est√© instalado</li>
                <li>Verifica SQL Server y detecta la instancia</li>
                <li>Crea el archivo secrets.json con la cadena de conexi√≥n correcta</li>
                <li>Verifica la estructura de proyectos</li>
                <li>Restaura todos los paquetes NuGet</li>
                <li>Compila el proyecto completo</li>
                <li>Muestra un resumen de configuraci√≥n</li>
            </ol>

            <h4>C√≥mo usar:</h4>
            <ol>
                <li>Descomprime el ZIP del proyecto</li>
                <li>Navega a la carpeta del proyecto</li>
                <li>Ejecuta <code>CONFIGURAR_PROYECTO_AUTOMATICO.bat</code> (doble clic)</li>
                <li>Sigue las instrucciones en pantalla</li>
                <li>Ejecuta el script SQL en SSMS para crear la base de datos</li>
            </ol>

            <div class="important">
                <h4>‚ö†Ô∏è IMPORTANTE:</h4>
                <p>Despu√©s de ejecutar el script .bat, debes ejecutar manualmente el script SQL en SQL Server Management Studio para crear la base de datos EPSDB.</p>
            </div>
        </div>

        <div class="step">
            <h3>11.6 Paquetes NuGet Requeridos</h3>
            <p>El proyecto usa los siguientes paquetes NuGet que se restauran autom√°ticamente:</p>
            
            <table>
                <tr>
                    <th>Proyecto</th>
                    <th>Paquete</th>
                    <th>Versi√≥n</th>
                </tr>
                <tr>
                    <td rowspan="2">lib_dominio</td>
                    <td>System.ComponentModel.Annotations</td>
                    <td>5.0.0</td>
                </tr>
                <tr>
                    <td>Newtonsoft.Json</td>
                    <td>13.0.3</td>
                </tr>
                <tr>
                    <td rowspan="3">lib_repositorios</td>
                    <td>Microsoft.EntityFrameworkCore</td>
                    <td>8.0.8</td>
                </tr>
                <tr>
                    <td>Microsoft.EntityFrameworkCore.SqlServer</td>
                    <td>8.0.8</td>
                </tr>
                <tr>
                    <td>Microsoft.EntityFrameworkCore.Tools</td>
                    <td>8.0.8</td>
                </tr>
                <tr>
                    <td rowspan="2">asp_servicios</td>
                    <td>Microsoft.AspNetCore.OpenApi</td>
                    <td>8.0.15</td>
                </tr>
                <tr>
                    <td>Swashbuckle.AspNetCore</td>
                    <td>6.6.2</td>
                </tr>
                <tr>
                    <td rowspan="4">EPS.Tests</td>
                    <td>coverlet.collector</td>
                    <td>6.0.0</td>
                </tr>
                <tr>
                    <td>Microsoft.NET.Test.Sdk</td>
                    <td>17.8.0</td>
                </tr>
                <tr>
                    <td>xunit</td>
                    <td>2.5.3</td>
                </tr>
                <tr>
                    <td>xunit.runner.visualstudio</td>
                    <td>2.5.3</td>
                </tr>
            </table>
        </div>

        <hr style="margin: 40px 0; border: 2px solid #7B2CBF;">
        <p style="text-align: center; color: #7B2CBF; font-size: 18px;">
            <strong>¬°√âxito en tu sustentaci√≥n! üéì</strong><br>
            Fecha: <span id="fecha2"></span>
        </p>
    </div>

    <script>
        const fecha = new Date().toLocaleString('es-ES', { 
            year: 'numeric', 
            month: 'long', 
            day: 'numeric', 
            hour: '2-digit', 
            minute: '2-digit' 
        });
        document.getElementById('fecha').textContent = fecha;
        document.getElementById('fecha2').textContent = fecha;
    </script>
</body>
</html>

